<script>
    async function fetchBlueskyPosts() {
        try {
            // Fetch data from the Bluesky Worker API
            const response = await fetch("https://bluesky-auth-worker.chamcgill.workers.dev/");
            const data = await response.json();

            // Find the posts container
            const postsContainer = document.getElementById('posts');
            if (!postsContainer) {
                console.error("Error: Element with ID 'posts' not found in HTML.");
                return;
            }

            postsContainer.innerHTML = ''; // Clear "Loading..." text

            // Loop through each post and add it to the page
            data.forEach(post => {
                const postElement = document.createElement('div');
                postElement.className = 'post';
                postElement.innerHTML = `
                    <p>${post.text}</p>
                    <a href="${post.url || '#'}" target="_blank">View Post</a>
                    <hr>
                `;
                postsContainer.appendChild(postElement);
            });

        } catch (error) {
            console.error("Error fetching Bluesky posts:", error);
            document.getElementById('posts').innerHTML = `<p class='error'>Failed to load posts.</p>`;
        }
    }

    fetchBlueskyPosts();
</script>
