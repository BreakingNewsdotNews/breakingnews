<script>
    async function fetchBlueskyList() {
        const apiUrl = "https://bsky.social/xrpc/app.bsky.feed.getTimeline";
        const username = "YOUR_BSKY_USERNAME"; // Replace with your Bluesky username
        const password = "YOUR_APP_PASSWORD"; // Replace with the API key you generated

        try {
            // Authenticate to get a session token
            const authResponse = await fetch("https://bsky.social/xrpc/com.atproto.server.createSession", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ identifier: username, password: password })
            });

            if (!authResponse.ok) throw new Error("Failed to authenticate");

            const authData = await authResponse.json();
            const accessToken = authData.accessJwt;

            // Fetch posts using API
            const response = await fetch(apiUrl, {
                headers: { "Authorization": `Bearer ${accessToken}` }
            });

            if (!response.ok) throw new Error("Failed to fetch posts");

            const data = await response.json();
            const postsContainer = document.getElementById('posts');
            postsContainer.innerHTML = '';

            data.feed.forEach(post => {
                const postElement = document.createElement('div');
                postElement.className = 'post';
                postElement.innerHTML = `<p>${post.post.record.text}</p><a href="https://bsky.app/profile/${post.post.author.handle}" target="_blank">View Profile</a>`;
                postsContainer.appendChild(postElement);
            });

        } catch (error) {
            console.error("Error fetching Bluesky posts:", error);
            document.getElementById('posts').innerHTML = `<p class='error'>Failed to load posts.</p>`;
        }
    }

    fetchBlueskyList();
</script>
